{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Missing Data Imputation\n",
    "\n",
    "We demonstrade in this section an application of our method to impute missing values in experimental data."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "from sklearn.model_selection import train_test_split\n",
    "\n",
    "import emachine as EM\n",
    "import itertools\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "np.random.seed(1)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "An smoking data was used to illustrate the idea. The data set contains 1536 samples of 38 binary variables."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(1536, 38)\n"
     ]
    }
   ],
   "source": [
    "s0 = np.loadtxt('smoking_data_processed.txt')\n",
    "print(s0.shape)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Splitting the data into training samples and test samples\n",
    "We first split the data into 460 training samples and 1076 test samples."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(460, 38) (1076, 38)\n"
     ]
    }
   ],
   "source": [
    "s_train,s_test = train_test_split(s0,test_size=0.7,random_state = 1)\n",
    "print(s_train.shape,s_test.shape)\n",
    "\n",
    "#np.savetxt('s_train.dat',s_train,fmt='%i')\n",
    "#np.savetxt('s_test.dat',s_test,fmt='%i')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x230.4 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "nx,ny = 2,1\n",
    "fig, ax = plt.subplots(ny,nx,figsize=(nx*4,ny*3.2))\n",
    "\n",
    "ax[0].set_title('training set')\n",
    "ax[0].imshow(s_train.T[:,:101],cmap='gray',origin='lower')\n",
    "\n",
    "ax[1].set_title('original test set')\n",
    "ax[1].imshow(s_test.T[:,:101],cmap='gray',origin='lower')\n",
    "\n",
    "for i in range(nx):    \n",
    "    ax[i].set_xlabel('sample')\n",
    "    ax[i].set_ylabel('variable')\n",
    "    ax[i].set_yticks([0,10,20,30])\n",
    "       \n",
    "plt.tight_layout(h_pad=0.5, w_pad=0.6)\n",
    "#plt.savefig('fig1.pdf', format='pdf', dpi=100)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Inferring the local fiels and pairwise interactions with the training samples\n",
    "We then apply EM method to predict the local fields `h0` for individual variables and pairwise interactions `w` between variables."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(460, 741)\n"
     ]
    }
   ],
   "source": [
    "ops = EM.operators(s_train)\n",
    "print(ops.shape)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.7 -90.97125777628806\n",
      "0.71 -90.0370848291644\n",
      "0.72 -89.15520227069703\n",
      "0.73 -88.32627999469725\n",
      "0.74 -87.55128825637009\n",
      "0.75 -86.83153251386894\n",
      "0.76 -86.16869719480155\n",
      "0.77 -85.56490097359782\n",
      "0.78 -85.02276703643429\n",
      "0.79 -84.54551302868458\n",
      "0.8 -84.13706706648992\n",
      "0.81 -83.80221856526629\n",
      "0.8200000000000001 -83.5468160312931\n",
      "0.8300000000000001 -83.37802891266647\n",
      "0.84 -83.30469797326157\n",
      "0.85 -83.33780984673744\n",
      "0.86 -83.49114880046875\n",
      "0.87 -83.7822063148659\n",
      "0.88 -84.2334739245864\n",
      "0.89 -84.87431965602296\n",
      "0.9 -85.74377728370874\n"
     ]
    }
   ],
   "source": [
    "eps_list = np.linspace(0.7,0.9,21)\n",
    "E_eps = np.zeros(len(eps_list))\n",
    "w_eps = np.zeros((len(eps_list),ops.shape[1]))\n",
    "for i,eps in enumerate(eps_list):    \n",
    "    w_eps[i,:],E_eps[i] = EM.fit(ops,eps=eps,max_iter=100)\n",
    "    print(eps,E_eps[i])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Text(0, 0.5, 'Energy')"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAYoAAAEKCAYAAAAMzhLIAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDMuMC4zLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvnQurowAAIABJREFUeJzt3Xt8VNW5//HPE24lSEQBr0jGUm+IBRXvekBARbygoFWJR8BLEHmhYL2A0bbHc2ItoiK1/jSiInWkWlHxBogoVFCqUASviEoCghZBGooREPL8/pgNDTCZTCAze5J836/XvNiz9u3JJjNP9lp7rWXujoiISGWywg5AREQymxKFiIgkpEQhIiIJKVGIiEhCShQiIpKQEoWIiCSkRCEiIgkpUYiISEKhJQoz62Rmc83sAzObZ2bHB+W9zWxRhfJTw4pRRETAwuqZbWavA/e7+xQz6wXc4u5dzWwP4Ad3dzP7JfCsux+e6FitWrXySCSShqhFROqO+fPnr3b31lVt1zAdwVTCgZxgeU9gJYC7r6+wTbNgu4QikQjz5s2r8QBFROoyMytJZrswE8UwYJqZjSZWBXby1hVmdiHwe2Af4Jx4O5tZPpAP0LZt25QHKyJSX6W06snM3gD2i7OqAOgOzHL3SWb2KyDf3XvssP9/Ab/ZsXxHnTt3dt1RiIhUj5nNd/fOVW4XYhtFKdAiaIswoNTdc+JstxQ4zt1XV3YsJQoRkepLNlGE+XjsSqBLsNwNWAJgZr8IEgdmdgzQGFgTSoQiIhJqG8U1wANm1hDYQNDeAPQFrjCzn4AfgUtck2aIiIQmtDsKd5/t7se6e0d3P8Hd5wflf3D3I929k7uf5O6zw4pRRKonGo0SiUTIysoiEokQjUbDDklqgHpmi0iNiEaj5OfnU1JSgrtTUlJCfn5+0slCSSZzKVGIyDa78mX9008/sXTpUm688UbKysq2W1dWVsbw4cOZPXs2ixYtoqSkhLVr17J58+adzrs7SUZSK7SnnmqSnnoS2X1bv6wrftlnZ2fz0EMPceqpp1JcXExJSQnFxcXbvVasWEF5eXm1z9esWTNycnLIyclh6dKlbNq0aadtcnNzKS4u3p0fSxLI+Mdja5IShcjui0QilJRU3VE3KyuLNm3aEIlEyM3NJRKJEIlEGDlyJKtWrdpp+/32248JEyawbt06SktLWbdu3XbLpaWl/PWvf630fHfffTfdu3fn6KOPpkGDBrv1M8r2kk0UYT71JCIh27RpE3PmzGHKlCkJk8QTTzyxLSm0adOGRo0a7bRNkyZN4t6RjB49mjPOOCNhHJUlqYYNGzJixAgAWrRoQdeuXenWrRvdu3fniCOOIHiSnmg0SkFBAcuWLaNt27YUFhaSl5eX1DWQJLh7rX8de+yxLiIxTz31lOfm5rqZeW5urj/11FPbrV++fLkXFRX5BRdc4M2bN3fAGzVq5E2aNHFiY6tt98rNza2xcyfaLzs7e7vzZmdn+1NPPeXffPONR6NRv+qqqzwSiWxbv99++3m/fv386quv9qZNm8bdVxID5nkS37Ghf8nXxEuJQiSmsi/cgoICv/nmm71Dhw7byg866CAfNGiQv/jii75u3bqEX9bpij2ZJPPVV1/5uHHj/LLLLvN99903bnKrboKrr5JNFGqjEKlDErUzNGrUiNNOO42zzz6bs88+m/bt22+rutmqtlXhuDsNGjQg3veYme1SI3t9osZskXooKyur0i/N0tJSmjdvHkJUqZUoOQ4ePJgRI0ZohOlK1IaxnkSkBmzZsoXnn3+erl27xk0SEBuKvy4mCYDCwkKys7O3K2vatCmnn34648aN4xe/+AWDBg3SY7a7QYlCpJZau3Yto0ePpl27dvTt25fi4mIuu+wymjZtut122dnZFBYWhhRl6uXl5VFUVERubi5mRm5uLo8++ihvvvkmX3zxBddccw3jx4/nkEMO4aqrruLLL78MO+TaJ5mGjEx/qTFb6pNPPvnEBw8evK3huUuXLj5p0iT/6aef3H3Xnzyqy77++msfOnSoN2nSxBs0aOD9+/f3zz//POywQoeeehKpvXb8sv/zn//sr776qp955pkOeJMmTXzgwIG+YMGCsEOtVVauXOnDhw/3pk2belZWll9++eU+atSoeptYk00UaswWyTDxhtIwM9yd/fffn+uuu45BgwbRunXrEKOs3f75z39y7733MmbMGH766aft1mVnZ1NUVJTRT3vVFD31JFJLVfYUT6tWrVixYgWNGzcOIaq66aCDDuLrr7/eqby+jDGlp55EaqHNmzdX+qjnmjVrlCRq2IoVK+KWL1u2LM2RZDYlCpEM8frrr9OpU6dK16svQM2r7Jo2aNCARYsWpTmazBVa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JLKDisPYN23alB9//JF//OMfdOrUKS3nT7YfRSgd7sysFGjh7m6xB9ZL3T0nznbFQGd3X53oeOpwJ/FkZWXFnZLSzCgvLw8hIpHKrVmzhg4dOtC6dWvef//9bVPqplKmd7hbCXQJlrsBSwDMbL8gcRA8CZUF1K6+7pIRli1bRoMGDeKuy8Q6YJGWLVvy6KOP8uGHH3LnnXeGHc52wkoU1wD3mtlC4C6CKiTgIuCjoHwscKnXhTFGJK0+/fRTTjnlFBo1arTTX2Ua1E8y2bnnnsuVV17J3Xffzd///veww9lGYz1JnfL3v/+dXr160bhxY6ZOncpHH320rQ64bdu2FBYWZlxnJpGKSktLOeqoo2jatCkLFizYqcG7JmV61ZNIjXv99dfp3r07LVq0YPbs2XTs2JG8vDyKi4spLy+nuLhYSUIy3p577snjjz/O559/njGd75QopE549tlnOffcc2nXrh2zZ8+mXbt2YYcksst69OjBkCFDGDNmDLNmzQo7HCUKqf0eeughLr30Uk488URmzZrF/vvvH3ZIIrvtD3/4A+3atWPgwIH8+9//DjUWJQqptdydO++8kyFDhnDuuecybdo0WrRoEXZYIjWiWbNmPPnkkxQXF3PzzTeHGosShdRK5eXlXH/99dtmo5s0adJO05aK1HannHIKv/71r3nkkUeYNm1aaHHoqSepdTZt2sSAAQOYOHEiv/71rxk1ahRZWfqbR+qmDRs2cMwxx7Bu3To++uijGr1r1lNPUif98MMPnH/++UycOJG7776be+65R0lC6rSf/exnTJgwgW+//ZYbbrghlBj0CZOMV3EE2L333ptp06bx6KOPcuutt2rKUqkXOnfuTEFBARMmTODFF19M+/mVKCSj7TgC7KZNm2jSpInaI6TeKSgooFOnTgwaNIjvvvsuredWopCMVlBQQFlZ2XZlGzduzJiOSCLp0rhxYyZMmMDatWsZPHhw3AEvU0WJQjJabZoFTCTVjjrqKO68804mTZrEX/7yl7SdV4lCMtaqVas0AqzIDm666SZOPPFErr76atq0aUNWVhaRSIRoNJqycypRSEZavXo1PXr0wMw0AqxIBQ0bNqRv376UlZWxYsUK3J2SkhLy8/NTliyUKCTjfP/995xxxhksWbKE1157jccee4zc3FzMjNzcXIqKijS4n9RrDz744E5lZWVl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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.plot(eps_list,E_eps,'ko-')\n",
    "plt.xlabel('$\\epsilon$')\n",
    "plt.ylabel('Energy')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The optimal value of eps: 0.84\n"
     ]
    }
   ],
   "source": [
    "ieps = np.argmax(E_eps)\n",
    "print('The optimal value of eps:',eps_list[ieps])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "So our inferred interactions from EM should be:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "w_em = w_eps[ieps]\n",
    "#np.savetxt('w_em.dat',w_em,fmt='%f')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "As the output `w_em` is a combination of local fields `h0` and pairwise interactions `w`, we have to split them for demonstration."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "n_var = s_train.shape[1]\n",
    "h0 = w_em[:n_var]\n",
    "w1d = w_em[n_var:]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [],
   "source": [
    "def convert_1d_to_2d(n_var):\n",
    "    ij2d = np.zeros((n_var,n_var))    \n",
    "    count = 0\n",
    "    for i in range(n_var-1):\n",
    "        for j in range(i+1,n_var):\n",
    "            ij2d[i,j] = count \n",
    "            count += 1           \n",
    "    return ij2d.astype(int)\n",
    "\n",
    "ij2d = convert_1d_to_2d(n_var)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "w2d = np.zeros((n_var,n_var))\n",
    "for i in range(0,n_var-1):\n",
    "    for j in range(i+1,n_var):\n",
    "        w2d[i,j] = w1d[ij2d[i,j]]\n",
    "\n",
    "w2d = w2d + w2d.T"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The local fieds and interactions are plotted."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x230.4 with 3 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "nx,ny = 2,1\n",
    "fig, ax = plt.subplots(ny,nx,figsize=(nx*3.5,ny*3.2))\n",
    "\n",
    "ax[0].plot(h0,'ko',markersize=3)\n",
    "ax[0].set_xlabel('variable')\n",
    "ax[0].set_ylabel('local field')\n",
    "\n",
    "ax[1].set_title('interaction matrix')\n",
    "im = ax[1].imshow(w2d,cmap='rainbow',origin='lower')\n",
    "plt.colorbar(im,ax=ax[1],fraction=0.045, pad=0.05,ticks=[-1.0,0,1.0])\n",
    "ax[1].set_xlabel('variable $i$')\n",
    "ax[1].set_ylabel('variable $j$')\n",
    "\n",
    "ax[0].set_xticks([0,10,20,30])\n",
    "ax[0].set_yticks([-1,0,1])\n",
    "ax[1].set_xticks([0,10,20,30])\n",
    "ax[1].set_yticks([0,10,20,30])\n",
    "\n",
    "plt.tight_layout(h_pad=0.5, w_pad=0.6)\n",
    "#plt.savefig('fig1.pdf', format='pdf', dpi=100)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Imputing missing values of the test samples"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "To create a nasty test set with missing values from the original test set, we first find unconserved variables."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[8, 18, 33, 36]\n",
      "number of active variables: 34\n"
     ]
    }
   ],
   "source": [
    "# find conserved variables\n",
    "fc = 0.9\n",
    "l,n = s_test.shape\n",
    "frequency = [max(np.unique(s_test[:,i], return_counts=True)[1]) for i in range(n)]\n",
    "cols_conserved = [i for i in range(n) if frequency[i]/float(l) > fc]\n",
    "print(cols_conserved)\n",
    "\n",
    "cols_active = np.delete(np.arange(0,n),cols_conserved)\n",
    "print('number of active variables:',len(cols_active))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We then randomly select `n_hidden` variables in the test samples and define them as missing values."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "n_hidden = 14\n",
    "s_hidden_all = np.array([])\n",
    "for t in range(l):\n",
    "    s = s_test[t].copy()\n",
    "    hidden = np.random.choice(cols_active,n_hidden,replace=False)       \n",
    "    s[hidden] = 0\n",
    "    s_hidden_all = np.vstack([s_hidden_all,s[np.newaxis,:]]) if s_hidden_all.shape[0]>0 else s"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAjgAAACUCAYAAACeNFNKAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDMuMC4zLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvnQurowAAIABJREFUeJztnXnYJUWVp98jIAg0VSxKVwFSLoiAC1KfCq2OqDiio2KPuC/Yo1Iu84xO6zigtlSpPepMd9vYdmsxrUKLsrQLAqLoIEiLinyFymKBC6IFXymFbAIjspz+I/NSWVmRcSPy5l3r9z7P99S9mRFxTkbmPRV54pwIc3eEEEIIIWaJB4xbASGEEEKIrtEARwghhBAzhwY4QgghhJg5NMARQgghxMyhAY4QQgghZg4NcIQQQggxc2iAswVhZp80s7/qumyfdpaZmZvZ1oO2JYSYbszsdjN7+Lj1EFsGGuBsQbj7m9z9A12XHQQzu9bMDuugndeZ2Xe60CnQtpvZI4fRthBbEu6+o7tf01V7ZnaomV3XUVsXmNkbumir1u7QbJOIowHOFoKZbTVuHYQQQohRoQHOFGNm+5VvHbeY2ZVm9sLKuRPN7BNmdo6Z3QE8ozz2wUqZd5nZejNbMLM3VD0V1bK9tyQze4eZ3VDW+YtKO//JzH5oZreZ2TozW5mo/2eBhwJnla7rd5XHDzaz75bX9WMzO7RS53Vmdo2Z/d7MfmlmrzKz/YBPAoeU7dzSIG+zupVz/8XM1prZzWZ2rpntXR6/sCzy47Ltl6VcmxCzSul1faeZXWZmt5rZaWa2XeX8G83s52Z2k5mdaWZLK+eqNuZ5ZvaT8vd4vZm9szx+hZm9oFJnGzO70cwOrOmxA/A1YGn527zdzJaa2QPM7Bgz+4WZ/c7MTjezXco625nZyeXxW8zsEjPb3cz+Gnga8PGynY8HrjtYtzy3yMw+VdrG683sg2a2VaptEkPC3fU3hX/ANsDPgXcDDwSeCfwe2Lc8fyJwK/AUioHsduWxD5bnDwd+AxwAbA98FnDgkZX6vbKHAvcA7y/lPg+4E9i5cv6xpZzHAb8FXlSeW1a2u3XDdVwLHFb5vgfwu1LGA4Bnl98fDOwA3Fa5xiXAAeXn1wHfifRXrO6Lyr7cD9gaeC/w3Urd+/tFf/rb0v/K3+wPgKXALsBa4E3luWcCNwIHAdsC/wBcWKlbtTHrgaeVn3cGDio/vws4rVLnCODyBl0OBa6rHXs78H1gz1KH1cAp5bkVwFmlzdsKWA7sVJ67AHhD5Lpjdc8o5ewAPKTsnxXluaht0t/w/uTBmV4OBnYEPuzuf3T3bwFnA6+olPmKu1/k7ve5+x9q9V8KfMbdr3T3O4FVfeTdDbzf3e9293OA24F9Adz9Ane/vJRzGXAK8PSW1/Vq4Bx3P6ds75vAPMWAB+A+4DFm9iB3X+/uV2a03VR3BfAhd1/r7vcA/ws4sOfFEUJsxsfcfcHdb6L4T7/nXXkV8Gl3v9Td7wKOpfBeLAu0cTewv5nt5O43u/ul5fGTgeeZ2U7l99dQvIClsgJ4j7tfV+qwEjjSikSHu4FdKQZZ97r7Gne/LbHdYN3Si/Nc4O3ufoe73wB8FHh5hs5iCGiAM70sBda5+32VY7+i8ID0WNevfmJZgN+V//n3uJNigIWZPdnMzjezDWZ2K/AmYLd+F9DA3sBLShfwLaVL96nAEne/A3hZ2f56M/uqmT06pdE+dfcGjq/IuwkwNu1LIcRGflP5fL8toLArv+qdcPfbKTywod/SiyleXH5lZt82s0PKOgvARcCLzWwxxeDhcxm67Q18ufJ7XgvcC+xOMVA6FzjViqn5/21m2yS221R3bwrP9vqKzNUUnhwxRjTAmV4WgL3MrHoPHwpcX/ke2yp+PYULt8deA+jyeeBMYC93X0Qx52yJdes6rgM+6+6LK387uPuHAdz9XHd/NsUU01XA/21oZ3NBzXXXUbiTqzIf5O7fTbwGIUTBAsV/+MD9cTK7sqldAsDdL3H3IygGAmcAp1dOn0ThzX0J8D1336x+r5nAsXXAc2u/5+3c/frSA73K3fcH/gx4PvDaSFtVfZvqrgPuAnaryNvJ3Q9IaVcMDw1wppeLgTuAd5VBeIcCLwBOTax/OvAXVgQqbw+8bwBd/gS4yd3/YGZPAl6ZUfe3QHVdjJOBF5jZc8ogve2sCHLeswwGfGFpNO+imCa7t9LOnmb2wJCQPnU/CRxrZgeUZReZ2UsiOgohwnyewq4caGbbUkz3Xuzu11YLmdkDrUgQWOTud1PEx91bKXIGRRzP24B/icj7LbCrmS2qHPsk8NeVRIEHm9kR5ednmNljrcgqvY1i2qlqQxp/50113X098A3gb81spzLI+RFm1pumj9omMTw0wJlS3P2PwAsp3Lc3Av8EvNbdr0qs/zXgY8D5FAG23ytP3dVCnbcA7zez31MMlE7vU77Kh4D3lq7dd7r7OoqgwncDGyjejv4HxbP6AOAdFG+JN1HE+bylbOdbwJXAb8zsxoCcxrru/mXgIxSu59uAKyj6tcdK4KRSx5dmXJsQWxTufh7wV8AXKbzEj6A5FuU1wLXlb+5NFB6bXjv/v2zjYcCXIvKuooj5u6b8fS4FjqfwKH+jtEnfB55cVvlT4AsUA5S1wLcpXqoo6x1pRSblxwLiYnVfS5Hs8RPg5rLckvJcP9skhoS5y3smipRziv/Yt63F2gghxMgxs/cBj3L3V/ctLEQAeXC2YMzsz0tX8c4UHoyzNLgRQoybct2a1wMnjFsXMb1ogLNls4JiGugXFPPQbx6vOkKILR0zeyPF1PTX3P3CfuWFaEJTVEIIIYSYOeTBEUIIIcTMsfW4FUhht91282XLlm1ybM2aNQAsX758s/L1c73vIUJl6sdSZITO1duLlUkt31ZeW7mx+k391FZGqO1YmZS2Q/3WRr9Qndz71EZ+atlhPHMpbffOuXvqukcTx/bbb++LFy9m6dL7t0xiYWFhkzLVc71rXrJkCU2sX7++b5lQ2z25KfV7ZXLvda/N1GvqyemR8qzE9K7K7VG/7qqc3rlevbbPcfWe9tqqt12/70161/Wtyk25hzF59TZDZVL7sE5dl1DZ0PMRu94eofsSaqupXuy5bGtfpmKKam5uzufn5zc5ZlZcb0j/+rne9xChMvVjKTJC5+rtxcqklm8rr63cWP2mfmorI9R2rExK26F+a6NfqE7ufWojP7XsMJ65lLYr1zu1A5ylS5f6ihUrOO644+4/tmrVpjuXVM/1rnnlypWNbfbOxcqE2u7JTanfO5d7r3v1Uq+pfizlWYnpXZXbo37dVTm9c716bZ/j6j3ttVVvu37fm/Su61uVm3IPY/LqbYbKpPZhU9tN36vHUq+3R+i+hNpqqhd7Lmd6gGNmY1Ey5T/sWL0eufVnkbZ92dROF20NqkOX8ofR5iiZ5gGO7Mv0I/sy+jZHSVv7ohgcIYQQQswcGuAIIYQQYuaY2imqHJdbSpzNqBm3fDG9ruAun+cOXftT+yD37EssHiElpiQWT5ETF9F0rt7WoDEeKfE2MWK6xdoM1Us5l1MmVD7n2vrJTTkX+2217ed6m6nPbMqzU4+vqerdtg/rcURt49Y0RSWEEEIIUTK1HpwYTSPn1KyTtl6hNqRGo8fktc28SZEbq9+UPZWb1RFrO7V8U53cLLkmuV0GH+b0T9tsqNysrxixfnZ35ubmmJ+fn0kPTo/ct+h6vVRvST2TZFAPTOobfixDKUen1CymmC516rqFMpbq7fU71iQ/1bvUI2ZfYhlZ9TZzs7Bi15TyO8/1RtXbTrUvbe5P/bc2iH2RB0cIIYQQM8dMenCEEKNlFmJwhBCTiWJwhBBCCCFKNMARQgghxMwxFXtR5TLoMv9tt0VI2bKgq1VIc+Wm1E8t31QvN/C6zfYAbQOwuzwXoyt5ue0MutVCk4xYmVkmFnyassx/PXAy1J/14N3quVA7Kam+9SXxY4G9IbpKu869plBgbk7AdKxMyrYGsbZjuqWkgqcGJ6fUT7n3KTYj5d6FtrYIkfI81+XlbH2yevXqRtn9kAdHCCGEEDPH0IKMzWw74EJgWwpP0Rfc/TgzexhwKrALcCnwGnf/Y5+2HAbfTDF3o8eu3uxz09MHTQ3uUv+U8l2liafITe3Lepm2SwSkPDODetNC8nK8PKlyBl3aoE//jtTN06V9CW22WZEDpHkPYmmy9dTXfudS7lHojTm2SWjd4xTSs9529XPMaxFLJc9JxQ7p0Cbtukleitym+rmbsabIGsYikW09Rzn2JeYpS7339TJNz+Xq1atZWFiYuCDju4BnuvvjgQOBw83sYOAjwEfdfR/gZuD1Q9RBCDGbyL4IIaIMLQbHi+Hf7eXXbco/B54JvLI8fhKwEvhErK3ly5czPz8/sEci9c01Vi72hp7jSQnJahu7Uy+f60lpu/hfk75dLDLX1Iex/mrbz23bjN2vFO9OqHyOd6kLL1xKvFq/+nNzc0l6dEmX9mXp0qUcd9xxre1L7w00FodRJdZW7+035iWJtZfiLUl5DmJv2iHPU0r8R/3amso31cuNwcmJz8mNoalT9VrkPDOxcynxPane555+KWVC31P6OeaF6vVzzGOVEh+Uy1BjcMxsKzP7EXAD8E3gF8At7n5PWeQ6YI9h6iCEmE1kX4QQMYY6wHH3e939QGBP4EnAfqFiobpmdrSZzZvZ/IYNG4apphBiCpF9EULEGEmauLvfYmYXAAcDi81s6/Ita09goaHOCcAJUAQZd5Gq2mXqa2xaIlYmJSB30HTrlCmT2BRXKrFrqJcJlR2m3m37uUle2yDllOckpF/KFFkqOfrGygwapDwsBrUvS5cu9VWrVmVPbwTavP9zjrs9Neg2Vq9HPVAzlt5bpR6AHJp+6hG6tljadX06IjalFirX69eUIPDY9aYE5KY+A/Xps1AAco681EDiernUafmmaa/UabQcfWMp4LE+aQr7OOussxpl9WNoHhwze7CZLS4/Pwg4DFgLnA8cWRY7CvjKsHQQQswmsi9CiH4MM038cRRBfltRDKROd/f3m9nD2ZjG+UPg1e5+V6ytubk5n5+fb5IDpKUIt/WIpMpLoau33xSPQkoAdEi3tueGwTBS0JtkhNpM6ctYmyll+pWL6ZlCzrXkPjuVYyN16wzDvoQWNkt57nK9NCn2JcUj0aNtSnbsXCztOSUAOpZSHSrXti9TaBu0GguIzZEXCuStey1iz17Mk9JWp9DxpgUs+xGzHSkeq37esEHSxIeZRXUZ8ITA8Wso5suFEKIVsi9CiH6MJAZnUNasWdP3DTc3xbPr1OhcBn3DT517zamfswhUKilxNk1lQ+VT72WO927QvgzpkhOfFGsntXyMnHT2ts/ONNOzL6lxIz1SPCL19Nhq27G32Vx5dUJv3zHPQso97dVPiduI9UWufUmJ30hZMC/mSQm13dXsQMzDlnu9dXkhD0xdx1CbufYlJUYoFHvUdC3V7/VriaWn56KtGoQQQggxc0yFByeXNm/Rg2bZhOrV66TKDUW4x9rM8a7k9kWX2Tz9GGYcSqiNlAypkNxBvUO9eikeulDWWVvPT46Xpl+bVcax0F+XLFmyhBUrVkQ9BCHqb8O5Wz2E4i/q9yr0NpvirQjJjWXQxOxLylt47Fhd31CZnDiXWP2YTikyYttYVM/F2ozFlDTFosRinkLEPGUx+5Kjd0xu6FiOFy70XPaoL5o4iH2RB0cIIYQQM0ffAY6Z7W5mnzKzr5Xf9zcz7e8ihOgE2RghxDBImaI6EfgM8J7y+0+B04BPDUmnzejtRZVKzhTCMFOq6+3FdO1XPtZmylRcTF69zZjrOpecvmjTXhOJqc2btdmkX4u06axrSJHbr2y/8jnPSb82O+ZExmxjIG3hPEizLzG3fX0aKTUFvSlIN3Y/Y1MYIXmhNkN7SDURe1ZC+tenaFJ2P48FbKc+203XlJLiXK0Xuk859iW0R1RsWjSWwh2bCmyaNkuZigwdS+2Lup6hfo8FfA9qe1KmqHZz99OB+0rF7gHuHUiqEEJsRDZGCNE5KR6cO8xsVyj2dDGzg4Fbh6pVjV4aZ25aY9syOSPw3CDjnMDU3Df1QUe7g6ZEx0jxlKXUS30GUlKbc4K/U+9FSvB5TrBvbsB3LDC+6Xu/+v2uqYMg47HamPXr17Ny5crgW2UsSLjeH7H02JgnJdTXMXmxoMyUrQpi9qVeJnQu1nZuoHaPnH4OtR3zlKUQ6pOc7Sdiese8OynLCITkhPokdWG+qozY9YbITS9v6sPYM1/3Dg1iX1IGOH8JnAk8wswuAh7MxqXQhRBiUGRjhBCd03eA4+6XmtnTgX0BA65297uHrlmFXgzOCGIBNmEYHo2cWJpB401y+yu3XlvPTU79mPchxZuWQpdp8Sn3N1YvlsrbRn4uufepi9/kuG1ML0085rVI8V70O1Y/F3rDHzTdOeZ1yEnnrZJiX3L7pw0x3WIp8znE4oPatp2yfECq969OLBU8JK/eX6kxRzEZsficpjZTn/lVq1axsBDcLzeJxgGOmf3nhlOPKqeLvtRaqhBii0c2RggxTGIenBdEzjkg4yOEGATZGCHE0BjabuJdYmZZSjZNXaSm87adZhiUlADVtnrk1M+93mG0Pei0W05qdG7gc0rZttOEOfJifTnoM9viGRjt/HGH9OxLzLUeoz71U7a5ybmU3bkhLXg1RceUqY+QDimr2Ibqx/ZBapLVr1y971Km7/odq+sQmyqKtZOy03goFXuU9iV1Gqmub8p0X+wepsiN7TZfrz/IbuIpC/3tamYfM7NLzWyNmR1fZjwIIcTAyMYIIYZBShbVqcCFwIvL76+iWITrsFglM9sL+BfgTynWtzjB3Y83s13K+suAa4GXuvvNbZSHvLS11ADKlEDPHLltU5tTz9XltA3oDZVN8RrkeA/a9uWgwbZdBk7Xy7YNUm677EGbYPYmuU31RuWVKsm2MV3al9heVLG9iepv/bGAzSr1fgztNxVL4Y7JyPE4VUnxHOUEk8aI7a4d8mbVdcv1eIW8U02emxSPWWq5ruxwzL7EdEpZMqBapykQOdR27FlPSVcPeYl69XKf5xgpC/3t4u4fcPdfln8fBBYn1LsHeIe77wccDLzVzPYHjgHOc/d9gPPK70KILZc2Nkb2RQgRJcWDc76ZvRw4vfx+JPDVfpXcfT2wvvz8ezNbC+wBHAEcWhY7CbgA+J9ZWjPcReZy3qZTGMbb8KCelFQPVJsYmEG9LW3pIuW+DW3bzolB6ldvmPFb9XpDiEnLtjHDti/1t/CUN+Xq8dCxHrFU7qYyKboOUi7myWjy3KQuiheTX28r5t1JbbNOqC9zPE49QtebEouTQkyP1N9YipelR6y/2/ZXzHOVQui5GtS+xNLEf0+RyWAUC3GdXJ56AHA7kLxsopktA54AXAzsXhon3H29mT2kjeJCiOmmKxsj+yKECNE4wHH3P+lCgJntCHwReLu735YRC3E0cHQXOgghJo8ubEwX9mXRokWDqiGEmECS0sTNbGdgH2C73jF3vzCh3jbA2cC57v535bGrgUPLt6slwAXuvm+snbm5Oc/ZTTygR0/nxmOh6athkqJTrPyg+o76esdFrE8nmWHonfvMpZaZm5tjfn5+IF9yGxszCvsS2725Pi0RSgUPTQXUpzVibcfSaXMCoFPr9UgJ9Izt/J1qX3L7oK5rTrp2rvwYsV3Mc6arQvq31berabPcZz3WF022IzYVWWfYaeJvoMhwOBdYVf4b1mTTegZ8CljbMz4lZwJHlZ+PAr6Sp7IQYpZoY2NkX4QQ/ejrwTGzy4EnAt939wPN7NHAKnd/WZ96TwX+DbicIo0T4N0U8+SnAw8Ffg28xN1virU1qAdHCDE8BvXgtLExsi9CbBkMYl9Ssqj+4O5/MDPMbFt3v8rMoi5fAHf/DkXwYIhnZWkphJhlsm2M7IsQoh8pA5zrzGwxcAbwTTO7GWi/vecYmMQYnBCDxuDkXNMkXO8oUAxOvM0uYnA6YCJsTGzxsdy4j5S02ty4jyZieldJsS8paeIhUuJkUki5ltx4m7ZxVCmkxLnEYpVSnrkUvZvkNdE2xivWVoxYW8O0L30HOO7+5+XHlWZ2PrAI+HrnmgghtkhkY4QQwyC2Ds5OZdrlLpXDl5f/7ghE57WFECKGbIwQYpjEPDifB54PrGHjYlzVfx8+dO0S0BTERuptTVufjIppfWZmkIm1MfV059izEpvWyU2bbkNomiE2bdA2NTo2dZIiL6ZvjrzYlE9IbmyaMWX6K6WfQksE5EztVeXmpHvH+jI2rRraNyomr23KedP+VLF9ruqyFhbaz1bHFvp7fpmK+XR3/3VrCUIIEUA2RggxTKIxOO7uZvZlYPmI9MlmmG/hetOfTXQ/J4dJtzGhhfp61PebyvWkhN70U4JP6zJS38LrhN6iU/bQClHXLbQPUq4npH4sxfOUuqBiGy9WqO3QteVcb7291HMpz0fsenOD31OCyFP+v8zx9HVBym7i3zezJ3YuWQghCmRjhBCdk7LQ30+ARwG/Au6gnB9398cNX72CUWzVMAloq4bumcT7nMI0pYl3sNDfWG1Mz7603U4htlz/sNOO27Sdu5R/U1/EUsFz0+rbkrOtQZdbPPQI/TZyPU058ts+V23kx3QJ1Y/FoqXsQj4M+5KyDs5z2zQshBCJyMYIITonZR2cXwGY2UOobIQnhBBdIBsjhBgGfQc4ZvZC4G+BpcANwN7AWuCA4ao2WraUKRshJo1JsTEpwZWhcz0X+zACKHNXsY3Vy0lbrtrDekp1l9c56Kq9OdNmgwYwx4ilVrcNrs5NWR90ui1nxehYvVDAdf1capr4oFNxKUHGHwAOBn7q7g+j2OflooGkCiHERmRjhBCdkxJkPO/uc2b2Y+AJ7n6fmf3A3Z80GhXBzBzae1YmcS+q3IDProNOx7VP1ST087Qy6PNR7fs6g/RPB0HGY7UxIfvSNqC2iepbar2v2wY3t/Xu1GVB2uJ0bb0tsRTynJTilHvRNj09Jn/QgOTcZ6dtUHaXetbLpuxTFbIv9XvQJmV/2EHGt5jZjsC/AZ8zsxuAe9oIE0KIALIxQojOSRngXAgsBt4GvJpiI7z396tkZp+mWIb9Bnd/THlsF+A0YBlwLfBSd7+5X1vLly9nkDTxcTNt8T3D1HESUvWnyaszCc/OCPprrDZmyZIlrFixYpNjOTsyh9Jc632WEv/SVn6oXuitOHYfm960Q7qkbH0QepvvnQvJjy1aGCtTPxfywoVI8UikLJzXZqf10Lku4m3aeG7abk0RItQXKV60pjidnn6DbNWQEoNjwLnABRQb4J3m7r9LqHcicHjt2DHAee6+D3Be+V0IsWUjGyOE6Jy+Axx3X+XuBwBvpchy+LaZ/b+Eehey+W7ARwAnlZ9PAl6Up64QYtaQjRFCDIOUKaoeNwC/AX4HPKSlvN3dfT2Au68v172YOOru1UFd84MGR88q45pyGVTuKKe4JnEabYjTZhNjY3JSsWPTFKGpjK52+s5x+4eO5e5SnZJ2nRs0G0tBbxPUPIzViptk9Wuz7RRZPeA7FuybKz9lZ/YQOSsS5+oWmx4dlL4eHDN7s5ldQOHu3Q144yiWUDezo81s3szmN2zYMGxxQogxMQ4bU7Uvd9555zBFCSHGREqa+IeBU939R9mNmy0Dzq4EAF4NHFq+WS0BLnD3ffu1M4q9qELeklHvVD7uvahG4ZnI1XtQnUYdUNyVvEnciyqEu3eRJj5WGxOzLzkp4KF+jb35xt7Qc4KMY8GvXdiXpjfzmI6h+rE9u1Lab7ubeOxcm/4O1U/RO1QmN206dg/bLB+QKjeln0JLDTTtMxVb6K/KoPYlJQbnmDaGp4EzgaPKz0cBX+moXSHElCIbI4QYBn09OK0bNjsFOJTC5fxb4DjgDOB04KHAr4GXuHs9SDDU1kgDEWJenUkh9GbWVZvDvO5cvafhXlTpSt9Juu7EncZHrmhXNkb2ZXNkXyYT2Zc8hjbA6RIZoM2RAZpMZICmD9mXzZF9mUxkX/LIyaKaWmJxK7G4hHHrFCvf1QPeZZsp5MqYth9yV3KGoW/uMzdMXSaJ3kJ/odiBWOxMPb4gNUYjpT9T5MbK5upUJ1QmJreuW+hcKKMspZ9ziMUOhdpLyRyK1e9K7xT5EI/tSrkHPWL3IvQ95/eQWq9HSrxaW1IW+hNCCCGEmCo0wBFCCCHEzDG1MTgprvX6tXW5QNmg87sp6d65UwM50265acE56emp9VPajunddkHGrqe9UpcfSHkeu6of0jdUL+WaYsxqDE59iiclzTvXvsTSh0P3qK5DqGxMp5RF2tpORTSVqerSI5QiHEtPj02txer3iP2W2i64VydlSi92LjZVFNtPLHdn9ZgeOfYldH/b7mSfmBY/nDRxIYQQQohpYyo8OKNY6G/UDLrQX1fyu2xzEhn3fZ4kBl3or6nMoAv9jZuQfYm92dffOAfdCiB3y4RY2ylBs6G3/9i5nEXxQh6v2CJvddouMjdo2ynlUzxI1XJtr6XrMiFStsboV75OqC8GtS+rVq1i9erVLCwsyIMjhBBCCAFbSJq4EEK0IcVrEHtzDbWT4x3K1akee1PVqZ6uHSNnE8p+bcauqa0HIqVsylYNKV6aEIPenzpdbAPRZnPS1HuS4rXMSe/uckPNGPLgCCGEEGLm0ABHCCGEEDOHgowVZDzTAbjjvs+ThIKMw/Tsy6CBtVVC01ZN9VKDX3OmN2L3OpbenZJ+nLOzdLXt3KDZnODiGG37Mkasn3OCe9tOBbbd/bwtuQHLbco26TjU3cSFEEIIIaYNBRkLIbZoFhYWWgW09t44Q96apr1/qvVS2o6da+sFGPRtPkW32EJ/qW220TPVM9DUd209dalBwsMMrm0b6J1SP+WZiwXbpyxeGEtdb4s8OEIIIYSYOcbiwTGzw4Hjga2Af3b3D8fKr1mzBjPrNDal7bYI0xTLMYw4m2G2mRIbMqrYoVHGQ+XKb1s+ZUuMFHmTHr+Va19ipMSPhEjZ6qFH2zfWlNidVC9C/Tpz3/Tr5UPXO+gCgTnyq4QYD2qrAAAIHklEQVS8CE33NTcOKyXWKkZK7FHu85HyXIR+7zHPUyx+q1c+FL/VtCVGiGF4t0buwTGzrYB/BJ4L7A+8wsz2H7UeQojZQ/ZFCNFjHFNUTwJ+7u7XuPsfgVOBI8aghxBi9pB9EUIA45mi2gNYV/l+HfDklIqxaaS2bvfcHaFj5+ryU/QO1cttM2Vn9breqVMvqX3eRE5fhM4NumN47rRMXV7OM9Qkr06s71PI3Q09Zbot1na93iROS1VobV9CUxi9f0Npz7Hpp/q52F5FVdd83U0f22U6NtUUmoKpy0vdL6pph/Nq/foUxjDsS2in8tjqzCm7n6es7BsiNi0Ta6NJp5Q61XKxabcYKbYj1l+xabpQgHmK/Ng01qpVq1hYWOijcTPjGOCEenizX4OZHQ0cPXx1hBAzRLZ9WbRo0bB1EkKMgZEv9GdmhwAr3f055fdjAdz9Q5E6G4A7gBtHomS37Ib0HiXSe7TsBuzg7g8etyIg+zJFSO/RMs16t7Yv4xjgbA38FHgWcD1wCfBKd7+yT715d58bgYqdIr1Hi/QeLZOmt+zLdCC9R8uWqvfIp6jc/R4z+6/AuRRpnJ/uZ3yEECIF2RchRI+xrIPj7ucA54xDthBitpF9EULAdK1kfMK4FWiJ9B4t0nu0TKvedab1OqT3aJHeo2UgvadiN3EhhBBCiBymyYMjhBBCCJGEBjhCCCGEmDkmfoBjZoeb2dVm9nMzO2bc+jRhZnuZ2flmttbMrjSzt5XHdzGzb5rZz8p/dx63riHMbCsz+6GZnV1+f5iZXVzqfZqZPXDcOtYxs8Vm9gUzu6rs90Omob/N7L+Xz8gVZnaKmW03qf1tZp82sxvM7IrKsWAfW8HHyt/qZWZ20Pg0T0c2ZvhMo32B6bQxsi8bmegBjk3Xxnn3AO9w9/2Ag4G3lroeA5zn7vsA55XfJ5G3AWsr3z8CfLTU+2bg9WPRKs7xwNfd/dHA4yn0n+j+NrM9gP8GzLn7YyhSmV/O5Pb3icDhtWNNffxcYJ/y72jgEyPSsTWyMSNjGu0LTJmNkX2p4e4T+wccApxb+X4scOy49UrU/SvAs4GrgSXlsSXA1ePWLaDrnuWD9EzgbIrl7m8Etg7dh0n4A3YCfkkZKF85PtH9zca9knahWKbhbOA5k9zfwDLgin59DKwGXhEqN6l/sjEj0XPq7Eup19TZGNmXTf8m2oNDeOO8PcakSzJmtgx4AnAxsLu7rwco/33I+DRr5O+BdwH3ld93BW5x93vK75PY7w8HNgCfKV3f/2xmOzDh/e3u1wN/A/waWA/cCqxh8vu7SlMfT+PvdRp1njYbM432BabQxsi+bMqkD3CSNs6bJMxsR+CLwNvd/bZx69MPM3s+cIO7r6keDhSdtH7fGjgI+IS7P4FiL6GJcRU3Uc4nHwE8DFgK7EDheq0zaf2dwjQ8N3WmTudpsjFTbF9gCm2M7MumTPoA5zpgr8r3PYH2e6cPGTPbhsLwfM7dv1Qe/q2ZLSnPLwFuGJd+DTwFeKGZXQucSuFG/ntgsRX7+sBk9vt1wHXufnH5/QsUxmjS+/sw4JfuvsHd7wa+BPwZk9/fVZr6eKp+ryVTpfMU2phptS8wnTZG9qXCpA9wLgH2KSPAH0gRLHXmmHUKYmYGfApY6+5/Vzl1JnBU+fkoinnzicHdj3X3Pd19GUX/fsvdXwWcDxxZFptEvX8DrDOzfctDzwJ+woT3N4Xr+GAz2758Znp6T3R/12jq4zOB15bZDgcDt/ZczROMbMwQmVb7AlNrY2Rfqow7wCghAOl5FLsD/wJ4z7j1iej5VAp32WXAj8q/51HMN58H/Kz8d5dx6xq5hkOBs8vPDwd+APwc+Fdg23HrF9D3QGC+7PMzgJ2nob+BVcBVwBXAZ4FtJ7W/gVMo5vLvpniDen1TH1O4kP+x/K1eTpHJMfZrSLhG2ZjR6D9V9qXUc+psjOzLxj9t1SCEEEKImWPSp6iEEEIIIbLRAEcIIYQQM4cGOEIIIYSYOTTAEUIIIcTMoQGOEEIIIWYODXDERGJmF5jZ3Lj1EELMJrIxs48GOEIIIYSYOTTAEcmY2Q5m9lUz+7GZXWFmLzOz95nZJeX3E8rVM3tvRx81swvNbK2ZPdHMvmRmPzOzD5ZllpnZVWZ2kpldZmZfMLPtA3L/o5l9z8wuNbN/LffiEULMGLIxoks0wBE5HA4suPvj3f0xwNeBj7v7E8vvDwKeXyn/R3f/D8AnKZbbfivwGOB1ZrZrWWZf4AR3fxxwG/CWqkAz2w14L3CYux9EsaroXw7tCoUQ40Q2RnSGBjgih8uBw8zsI2b2NHe/FXiGmV1sZpdTbKR3QKX8mZV6V7r7ene/C7iGjZumrXP3i8rPJ1MsR1/lYGB/4CIz+xHF3iR7d35lQohJQDZGdMbW/YsIUeDuPzWz5RT733zIzL5B8cY05+7rzGwlsF2lyl3lv/dVPve+9569+l4h9e8GfNPdX9HBJQghJhjZGNEl8uCIZMxsKXCnu58M/A1wUHnqxnLO+sjGys081MwOKT+/AvhO7fz3gaeY2SNLHbY3s0e1kCOEmHBkY0SXyIMjcngs8H/M7D6K3V/fDLyIwj18LXBJizbXAkeZ2WqK3WM/UT3p7hvM7HXAKWa2bXn4vRS7PwshZgvZGNEZ2k1cjA0zWwacXQYPCiFEp8jGbNloikoIIYQQM4c8OEIIIYSYOeTBEUIIIcTMoQGOEEIIIWYODXCEEEIIMXNogCOEEEKImUMDHCGEEELMHP8OAnVUdNAIsioAAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 576x230.4 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "nx,ny = 2,1\n",
    "fig, ax = plt.subplots(ny,nx,figsize=(nx*4,ny*3.2))\n",
    "\n",
    "ax[0].set_title('original test set')\n",
    "ax[0].imshow(s_test.T[:,:101],cmap='gray',origin='lower')\n",
    "\n",
    "ax[1].set_title('noisy test set')\n",
    "ax[1].imshow(s_hidden_all.T[:,:101],cmap='gray',origin='lower')\n",
    "\n",
    "for i in range(nx):    \n",
    "    ax[i].set_xlabel('sample')\n",
    "    ax[i].set_ylabel('variable')\n",
    "    ax[i].set_yticks([0,10,20,30])\n",
    "       \n",
    "plt.tight_layout(h_pad=0.5, w_pad=0.6)\n",
    "#plt.savefig('fig1.pdf', format='pdf', dpi=100)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We now use the predicted local fiels and pairwise interaction from EM method to recover the test set."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Recovered accuracy: 0.8431359532660648\n"
     ]
    }
   ],
   "source": [
    "# every possibilities of configurations of hiddens\n",
    "s_hidden_possibles = np.asarray(list(itertools.product([1.0, -1.0], repeat=n_hidden)))\n",
    "n_possibles = s_hidden_possibles.shape[0]\n",
    "\n",
    "s_recover_all = np.array([])\n",
    "acc = np.zeros(l)\n",
    "# consider each specific sample t:\n",
    "for t in range(l):\n",
    "    s = s_hidden_all[t].copy()\n",
    "    \n",
    "    hidden = np.where(s==0)[0]    \n",
    "    s_possibles = np.tile(s,(n_possibles,1))    \n",
    "    s_possibles[:,hidden] = s_hidden_possibles\n",
    "\n",
    "    # calculate energy of each possible configuration\n",
    "    ops = EM.operators(s_possibles)\n",
    "\n",
    "    #----------------------------------------------\n",
    "    # recover by EM\n",
    "    energy = -ops.dot(w_em)\n",
    "    s_hidden_recover = s_hidden_possibles[np.argmin(energy)]\n",
    "    \n",
    "    # recovered accuracy\n",
    "    acc[t] = np.sum((s_test[t,hidden] == s_hidden_recover))\n",
    "    #print(acc[t])\n",
    "    \n",
    "    # recovered configurations\n",
    "    s_recover = s.copy()\n",
    "    s_recover[hidden] = s_hidden_recover\n",
    "    s_recover_all = np.vstack([s_recover_all,s_recover[np.newaxis,:]]) \\\n",
    "                    if s_recover_all.shape[0]>0 else s_recover\n",
    "       \n",
    "acc_av = acc.sum()/(n_hidden*l)\n",
    "print('Recovered accuracy:',acc_av)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The recovered data is plotted along with the original data and missing data."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 288x432 with 3 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "nx,ny = 1,3\n",
    "fig, ax = plt.subplots(ny,nx,figsize=(nx*4,ny*2.0))\n",
    "\n",
    "ax[0].set_title('original test set')\n",
    "ax[0].imshow(s_test.T[:,:101],cmap='gray',origin='lower')\n",
    "\n",
    "ax[1].set_title('noisy test set')\n",
    "ax[1].imshow(s_hidden_all.T[:,:101],cmap='gray',origin='lower')\n",
    "\n",
    "ax[2].set_title('recovered test set')\n",
    "ax[2].imshow(s_recover_all.T[:,:101],cmap='gray',origin='lower')\n",
    "\n",
    "for i in range(ny):    \n",
    "    ax[i].set_xlabel('sample')\n",
    "    ax[i].set_ylabel('variable')\n",
    "    ax[i].set_yticks([0,10,20,30])\n",
    "       \n",
    "plt.tight_layout(h_pad=0.5, w_pad=0.6)\n",
    "#plt.savefig('fig2.pdf', format='pdf', dpi=100)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Performance comparison with PLE"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "To estimate the performance of EM, we compute tha accuracy for various values of missing variables and compare with the PLE method. This work is performed separately. In the Jupyter Notebook, we just report the result."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [],
   "source": [
    "acc = np.loadtxt('acc.dat')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAARgAAADQCAYAAADcQn7hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDMuMC4zLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvnQurowAAIABJREFUeJztnXecFeX1/98flrqggIAVcRVrFFzDGolComLB3mJB/YqJCWnWaDQxGjE2NEZjiwrG3kDUaFDE8hMLKgpKFDTGhgoSRdQYigq75/fHmZu9LFvuluHu3nver9e87swzz8xznnvnnjlPO0dmRhAEQRq0y7cAQRAULqFggiBIjVAwQRCkRiiYIAhSIxRMEASpEQomCILUCAUTBEFqhIIJgiA1QsEEQZAa7fMtQEvRu3dvKysry7cYQVAUzJw581Mz69NQvoJRMGVlZcyYMSPfYgRBUSDp/VzyRRMpCILUSFXBSDpF0hxJsyXdJamzpJslvSdpVrKVJ3kPSfI+I6lXktZf0t1pyhgEQXqk1kSStAFwIvAtM1smaQJwRHL612Y2scYlpwKDkzxHAlcB5wNnt4hAlZUweTK88gpstx3stReUlLTIrVcrhVKPoChIuw+mPdBF0nKgFPionrxVQKck39eShgILzOytZktRWQl77gnTp8OSJdC1K+ywA0yZ0rb+nIVSj6BoSE3BmNl8SZcCHwDLgEfN7FFJRwIXSPo98ATwGzP7GjgXmIIroaOBbIunViSNAkYB9OvXr+6Mkyf7n3LxYj9evBiefhoOOgj69wcJ2rVr/GdTrmlOWTNmwLRp8NVX1fV47jm4/nrYe2/o0gVKS/2zfSvvvw9LrChQWg6nJPUE7gUOB74A7gEm4krl30BHYCzwjpn9oca1I4EewHTgNOBz4CQzW1pXeRUVFVbnKNJ558E550DNunbq5FtVlZ+r77Ot0aGDK5vMllE+LX3coYMrwcYQllibR9JMM6toKF+ar7ndgPfMbGEi0H3AjmZ2e3L+a0k34Qrkf0gqBUYCewKPAgfgfTJHAeOaJMl22/lDnLFgALp1g7vugn33ze0eZtVbVVVuSqmlPjP7Tz0FZ54Jy5ZVy9W5M5x4Imy1FSxd6tuyZdX7tR1/8smq55csaZoiLSlpvIL68EN45hn45hu/x+LFbpmNGQPDhnmerl1Xvr5Dh8bLtjoIS6xe0lQwHwCDE4WxDBgGzJC0npktkCTgQGB2jetOB64ws+WSugCG98+UNlmSvfbyN2TNN+Zee+V+D6n6TZ2vB2jgQJg0adV6XHhh82Uyg+XLc1NQuR5//jnMn7/q+eXLVy3/q6/grLN8q4327VdWONlbTWVU31Zf3s6dG2eNhSXWIGn2wUyXNBF4GVgBvII3iSZL6gMImAX8LHONpPWBCjMbnST9CXgBb2Id2GRhSkr8R588GWbNgvLytvmmSbMeEnTs6FuPHs2/X3088AAcdZT/KTN06QJnn+11ylZGS5d6vppp2du//117vqbQGIU0f/6qlthzz8HYsXDoodCzZ9t7xlqY1PpgVjf19sEErYvV8eY3c6uoLqXUkNLKJe9//7tqv142Eqy1FvTuvfLWp8+qaZltzTUb36eVB1pDH0wQ1M7qsCglt4q6dIFevVruvtlMmgQjRqzct9e5M/zyl9CvH3z66crbu+/Ciy/6fm3NRPC+prqUT11KqkuX5tclpb6ksGCCoKk01RIzgy+/XFUB1bYtXOifn31Wt7VUWtqwEsreevVaudO8CfUICyYI0qaplpgE3bv71r9/bmVVVnqneX1KKLO9/bZ/fvll3ffr3r1aAVVWuuWyYoWfW7zYlc3kybmPstZBKJggaA4lJf4nbOYfMadyMhZIrnzzDSxaVLsSyt5mz65WLhmWLHGlGQomCIJa6dgR1lvPt/qorS+pa1e3yJpJuGsIgmInM0+sWzdvvnXr1vh5YnUQFkwQFDspjuqFggmCILW+pGgiBUGQGqFggiBIjVAwQRCkRiiYIAhSIxRMEASpEQomCILUCAUTBEFqhIIJgiA1QsEEQZAaoWCCIEiNUDBBEKRG0SiYsrLqwACZraws31IFQWFTNArm/ffd4+Cxx8Lvfgdff+1pQRCkR9EoGKh22nXBBTB4cH5lCYJiIFUFI+kUSXMkzZZ0l6TOkjaWNF3SW5LGS+qY5D0hyfdwVtoQSZe1lDzt28NNN8H993twQYA//7ltRoYNgrZAagpG0gbAiXggtW2AEjyY/cXA5Wa2GR5z+rjkkh8DA/EAbXsmkR/PBs5radkOPNDdkAKce65HUg2CoOVJu4nUHugiqT0e+nUBsCswMTl/CytHbOyQ5FsO/B/wsJl93hKCbLTRyh28667raTNn+n5VFTzySP1xtIIgaBypKRgzmw9ciseoXgD8B5gJfGFmGRfm84ANkv1L8TCxfYBpwEjgL/WVIWmUpBmSZixcuLBeeebOXTl+vZmnbbKJn58wwb0EHnqoO1oPgqD5pNlE6gkcAGwMrA90BWrzImwAZnabmW1nZkcDvwKuBPaSNFHS5ZJWkdXMxppZhZlV9OnTp1nyHnoojBkDDz4IAwbAww8363ZBEJBuE2k34D0zW2hmy4H7gB2BHkmTCaAv8FH2RZLWB7Y3sweAs4DDga+BYSnKSkkJnHEGvPSSx6PaZx8455w0SwyCwidNBfMBMFhSadJhOwx4HXgS+EGSZyTwQI3rzsM7dwG64BZOFd43kzrbbutK5rTT4PvfXx0lBkHhklpUATObLmki8DKwAh8dGgs8BNwt6fwk7a+ZayRtl1z7SpL0V+A14EPg3LRkrUmnTvDHP1Yfn3WW99mcc47HsgqCIDdkBTJsUlFRYTNmzGjx+5rBqFFwww2w3XZw222w9dYtXkwQtCkkzTSziobyFdVM3qYgwbhx8Le/wbx5MGgQXH55TM4LglwIBZMjBxzgk/P23BN+8xt4++18SxQErZ9QMI1g7bXdkpk5Ezbf3NOefTYm5wVBXYSCaSQSbLON7z/xBAwdCj/4QUzOC4LaCAXTDHbeGS6+GCZNcqXz0EP5ligIWhehYJpBSQmcfrrPm1l7bY8b/utf51uqIGg9hIJpAQYOdCVz+ulQXp5vaYKg9ZDaRLtio1Mnby5luPZa9zkzenRMzguKl7BgUmLOHLjoIthhh2rfM0FQbISCSYmrr/Yh7fnzoaICLrssJucFxUcomBTJTM4bPhxOPdX7aYKgmAgFkzJrr+0+gF94wZtLALNmxeS8oDgIBbMakFZWLoMGwSGHQANO+IKgzRMKZjUzYIB7znvoId+fNCnfEgVBeoSCWc2UlPhkvJdegnXWgf32g+OPz7dUQZAOMQ8mTwwcCC++6E6sevfOtzRBkA6hYPJIp07eXMrwwAPeGXzuuTE5LygMGmwiSTo+iRAQpMxzz7nCicl5QaGQSx/MusBLkiZIGp448A5S4OKL3Yr56CMfaYrJeUFbp0EFY2ZnAZvhDriPBd6SdKGk/inLVpTsv79bL3vv7ZPzHnkk3xIFQdPJaRTJ3DP4v5NtBdATmCjpkhRlK1r69IH77oPHH/dokwD/+ldMzgvaHrn0wZwoaSZwCR7SdYCZ/RwYBBxSz3VbSJqVtX0p6WRJoyXNz0rfO8m/k6RXJb0kadMkrYekKcXYLJNg2DD/nDvXIxocfHBMzgvaFrlYML2Bg81sTzO7J4nSiJlVAfvWdZGZvWlm5WZWjiujpcD9yenLM+fMLBOk9VRcYZ0J/DxJOxu40AoltkoT2XBDH1l6+GFYd11XOtlbWVm+JQyC2slFwTwMfJY5kLSGpB0AzOyNHMsZBrxjZu/Xk2c5HsmxFFie9PFsYGZP5VhGwVJS4pEmZ8yo7vT9yU983wzer+9bDYI8kouCuRZYnHW8JElrDEcAd2UdH580h27MGgK/CI/8eDJwNXAB1SFka0XSKEkzJM1YWARthwED/POMM6C01K2XIGjN5KJglN1ESZpGOU/Qk9QR2B+4J0m6FugPlAMLgD8l951lZoPNbBdgE+Ajv1zjJd0uaZ2a9zazsWZWYWYVffr0yVWkNs+YMR78DXzuDLj3vCBobeSiYN5NOno7JNtJwLuNKGMv4GUz+xjAzD42s8pEUY0DvpOdOenQPQs4Dzgn2W4HTmxEmQVPxnp55x3//Na34KqroLIyfzIFQU1yUTA/A3YE5gPzgB2AUY0oYwRZzSNJ62WdOwioOWd1JPCQmX2O98dUJVtpI8osWDbaaOUO3mOOgQ02gJ12ghNPhB13hFdfzbeUQeA02NQxs0/wPpRGI6kU2B34aVbyJZLKAQPmZp9L8o8E9kiSLgPuBb7BFVXRM3du7elmcNddcPLJMGWKL6YMgnyjhkaAJXUGjgO2Bjpn0s3sR+mK1jgqKipsxowZ+RYj73z2Gay5JrRv7z5nOnf2+TRB0JJImmlmFQ3ly6WJdBu+HmlP4CmgL/Df5okXpMVaa7lyMfPO4N12g2OPhUWL8i1ZUIzkomA2NbOzgSVmdguwDzAgXbGC5iLBo4/CmWfCHXfAllv6Z3FPWQxWN7komOXJ5xeStgG6A2WpSRS0GF26wAUXwMyZ0L8/HH00TJ2ab6mCYiIXBTM2mQx3FvAg8Dpwcf2XBK2JgQNh2jSP07Tzzp724ouwYkVexQqKgHoVjKR2wJdm9rmZPW1mm5jZ2mZ2/WqSL2ghSko8TpMECxa4otl+e19+EARpUa+CSSbDhUvqAmPddeG22+Djj9173q9+BYsXN3xdEDSWXJpIj0k6TdKGktbKbKlLFqSG5HGZXn8dRo3yZQcDB8KSJfmWLCg0cllTlJnv8susNMPXCwVtmB494NprvfN32jTo2tXTlyyp3g+C5pCLy8yNa9lCuRQQO+0Ep5/u+88958sRbrwxhrSD5tOgBSPpmNrSzezWlhcnyDe9e/vCyeOO836a66+HzTfPt1RBWyWXPpjts7ahwGjc/UJQgGy+uc+VGTfO42gPHAiXXppvqYK2Si6LHU/IPpbUHV8+EBQo7drBj38M++4LJ52Ub2mCtkxTIjsuxcOYBAXOuuvC+PHVfTETJsBTT8GFF0L37vmVLWgb5BJV4O+SHky2ScCbwAPpixa0FjLOrd58E667zvto/va3/MoUtA1ysWCyW+ArgPfNbF5K8gStmLPPhuHD3eH4QQf5dtVV7vAqCGojl07eD4DpZvaUmU0DFkkqS1WqoNWy/fbw0kse5nbyZHj++XxLFLRmclEw9+AuKzNUUu3AOyhCOnTweTPvvOMzgsG96c2Zk1+5gtZHLgqmvZl9kzlI9jumJ1LQVlh/fe+f+fprD6Wy3XbejPrqq3xLFrQWclEwCyX9b96LpAOAT9MTKWhrdOoEL78MRxwB558P224bfmcCJ9eoAmdK+kDSB8AZrOzEOwjo3RtuvdW96K1Y4X6A33sv31IF+SaXiXbvAIMldcOdhIc/3qBOdt8dXnsNHnsMNt7Y02bMgEGDIhJlMZLLPJgLJfUws8Vm9l9JPSWdvzqEC9ompaXu3ArcXef22/us4IihXXzk0kTay8y+yBwkAdH2bugiSVtImpW1fSnp5MSfzGOS3ko+eyb5D5E0R9Izknolaf0l3d3UygX5p7wc/vxnnwH8rW+575lw1Vk85KJgSiR1yhxI6gJ0qic/AGb2ppmVm1k5MAhfYnA/8BvgCTPbDHgiOQY4FRgM3AocmaSdD5ydY12CVkhJia9nev112GUX9563227hCqJYyGUm7+3AE5JuSo5/CNzSyHKGAe+Y2fvJKNTOSfotwFS847gKV1ylwNeShgILzOytRpYVtEL69YO//x3uuQf+8x/vn6nZZNpoo7ojVwZtkwYjOwJIGg7sBgj4HFjPzH5Z/1UrXX8j8LKZXS3pCzPrkXXuczPrKWl3YAzwEXA0MAE4ImmS1XXfUSRxsvv16zfo/Wjktxkkn5x35pnuc2b33T0tLJu2QUtGdgT4N25hHIJbI280QpCOuP+Yemf/mtljZjbIzPYDDgQeBraQNFHSuCRudc1rxppZhZlV9OnTJ1eRglZC374+K3iPPWDkyHxLE6RBnQpG0uaSfi/pDeBq4EPc4tnFzK5uRBl74dbLx8nxx5LWS8pYD/ikRrmlwEjgL8BFuE/gmcBRjSgzaAMMGQL/+AecdRbceaen3X9/fmUKWpb6LJh/4tbKfmY2xMyuwtchNZYRwF1Zxw/iCoTks6brh9OBK8xsOdAFdzBehffNBAVG585w3nk+ExigsilPWNBqqa+T9xDgCOBJSY8Ad+N9MDmTWCO7s/LM3zHABEnH4Su1D83Kvz5QYWajk6Q/AS8AX+DNpqBA2GijVSfebbRR9eLJK6+Eqio44QQfiQraJg128krqiv+5RwC74iM/95vZo+mLlzsVFRU2I8IUFgRmcOihcO+9PknvhhvcN3DQemixTl4zW2Jmd5jZvkBfYBbVc1eCoMWRfDj7zjt92HrQIPjd72KVdlsk11EkAMzsMzO73sx2TUugIABXMiNGwBtveGC4MWN8jVPQtmiUggmC1U2vXnDTTfDPf3pzCdyy+bzO2VFBayIUTNAm2CyJY/Hhh3Dssb6uaeLEmJjX2gkFE7QpNtwQXngB1lvPO4IPOgjmz8+3VEFdhIIJ2hzf/ja8+CJccok7uNp+++gAbq2EggnaJO3bw69/7R2/V1/tE/bMYrFkayMUTNCm6d8fDj7Y98ePhy22gHPPdUfkQf4JBRMUDLvu6jOBR4/2ZtRzz+VboiAUTFAwrL22D2E/9BAsXuyLKUePzrdUxU0omKDg2HtvDwJ34onVSwxiODs/5OLRLgjaHN26uS/gDBdf7Cu2r7wS1l03f3IVG2HBBEVB+/bw4IOw1Vbw17+GRbO6CAUTFAWnnebOrQYOhB//2DuE334731IVPqFggqJhiy3gySdh7Fh49VVYtCjfEhU+oWCCoqJdO/jJTzyiwQ47eNoll8BLL+VXrkIlFExQlHTr5p9ffglXXQWDB8Opp8KSJfmVq9AIBRMUNWuuCbNnw09/CpddBttsA1Om5FuqwqGgh6mXL1/OvHnz+KqAVsJ17tyZvn370qFDh3yLUjB07w5/+QsceaQ3nw4+2JtQvXvnW7K2T0ErmHnz5rHGGmtQVlaGanqYboOYGYsWLWLevHlsvPHG+Ran4BgyBGbNgpkzXbmYwWOPVQeFCxpPQTeRvvrqK3r16lUQygVAEr169Sooi6y10akT7Lij7z/8MOy5JwwfDu+9l1+52iqpKhhJPZLIjP+U9Iak70oaLWm+pFnJtneSdydJr0p6SdKmWddPUTM0RKEolwyFVp/WzPDh3gH83HPeN3PZZbBiRb6lalukbcFcATxiZlsC21IdcvZyMytPtoeTtFPxWExnAj9P0s4GLrRcAmgHQQtTUgLHHw+vv+4T8049tTpuU5AbqfXBSFoT+B5wLICZfQN8U88bOBPJsRRYLqk/sIGZPZWWjKuDkpISBgwYwIoVK9hqq6245ZZbKC0tpVu3bixevHilvKNHj2bcuHFkx9meOnUqPXr0WN1iB1lsuKEvM5gwoXp4e/lyt2a6dMmvbK2dNC2YTYCFwE2SXpF0QxLEDeD4pDl0o6SeSdpFwFjgZDwW9gW4BbPaKCvzzrzsrayseffs0qULs2bNYvbs2XTs2JHrrruu3vynnHIKs2bN+t8WyqV1IMHhh8M++/jxpZf6soMnn8yvXK2dNEeR2gPfBk4ws+mSrsADtl0NnIfHnD4PDw/7IzObBQwGkPQ94CPf1XjcujnVzD7OLkDSKGAUQL9+/RoUaOedV0077DD4xS9g6VIfmvz+91c+/1RiP336KfzgByufmzq1wSJXYujQobz66quNuyholQwe7Ismd60lQthGG4XrzgxpWjDzgHlmNj05ngh828w+NrNKM6sCxgHfyb4o6dA9C1c+5yTb7cCJNQsws7FmVmFmFdnNitbIihUrmDx5MgMGDKg33+WXX055eTnl5eXssssuq0m6oLHsskt1ILiSEujRA26/3Ye2338/v7K1JlKzYMzs35I+lLSFmb0JDANel7SemS1Ish0EzK5x6UjgITP7XFIpUJVspc2VqT6Lo7S09jyZLqPevRtvsQAsW7aM8vJywC2Y4447rt78p5xyCqeddlrjCwpWO5n+l5kz4YIL3HLJ8PzzbuUU+6Bf2hPtTgDukNQReBf4IXClpHK8iTQX+Gkmc6JQRgJ7JEmXAfcC3wAjUpY1FTJ9MEHhsu223gGczY47wne+Ayef7E3rYp14neowtZnNSpowA83sQDP73Mz+z8wGJGn7Z1kzmNlSM9vFzJYnx88keQeZ2b/SlBX8DVSzkzf7rRQEuXLNNfDFF778oKzM59AUIwU9k7exzJ3rbejsLa3OuqVLl9K3b9//bZclT2B2H0x5eTlzo7ewVVPXS+kXv4A33nAH5FtvDW++WX1NMTm6Kui1SK2BmnNdMlRVVdWaPjrc4Lcp6tP/7dq5A/K9966eAfzCC/Dd7/r6ppNP9tnC7Qr4NV/AVQuC1kP75FW+2WZw4YUe9WCffdxH8DXXwLJl+ZUvLULBBMFqpFcv+O1v3fK58053FXH22dVOyAstImUomCDIAx06wIgRMH26z6cpLYWqKo9IedhhvsCyEFbghYIJgjwiwQYb+P5XX8F++8Hjj8NOO7nP4DvugG++ya+MzSEUTBC0EkpLYcwY+PBDuPZa9xd89NEwaVK+JWs6oWCCoJXRtSv87GfuJmLKFNh/f0//4x/dpefsmnPfWzGhYLKprPTXxXnn+WdlZbNvWVJSstK8ljFjxgCw8847069fP7Jd3Rx44IF0y/gDCIqedu1gjz2qR6C+/NKbTAMG+DD3Qw95v01rJubBZKisdP+I06d77IquXb0RPGWKr2ZrIvUtFejRowfTpk1jyJAhfPHFFyxYsKDWfEEA/t475RQYNw6uvhr23RdGjYLrr8+3ZHVTPArm5JPdo3NdLFrkNmnmlbB4sTv7KC/3scXaKC9fOcJ6IzniiCO4++67GTJkCPfddx8HH3wwc+bMafL9gsJnrbXgjDPgV7+C++6DjO/3d9/1yAjHH998H0YtSTSRMixevKq9WVXl6c0gs5o6s40fP/5/54YNG8bTTz9NZWUld999N4cffnizygqKhw4d3AHWdxJnJ88+6++6/v19ceWzz7aOYe7isWAasjQmTfKJCdkKpVs39/q8775NLra+JlJJSQlDhgxh/PjxLFu2jLLW9OoJ2hTHHOPOr665xptM997rSxKeeaZZLfxmExZMhr328j6Xbt18ckK3bn68116pFnvEEUdwwgkncNhhh6VaTlD49O0LF10E8+bBddd5R3BGudx4I3zyyeqXqXgsmIYoKfEO3cmTva+mvNyVS8rqf+jQofz2t79lxIg26e4maIWUlnoo3AxvvQXHHecxn446Ck46yf0Jrw5CwWRTUuLNoWY0iWqS7dEOYPjw4f8bqgaPcxQe7II02Wwzdx1x5ZVwyy1uzey6q49GbbJJumWHgkmZyjrm0kytw/9mXe4dgqA5bLmljzKdfz7ccAPcdhtk3FjPmQP9+sEaa7R8udEHEwRFxFprwemnw6uvukIx89Go7t1bPmQPhIIJgqIk44xc8vArZt5H88471d4cWyI6QsE3kcysoOI5RxTdoKXZYQf/XLAAevasP29jKWgLpnPnzixatKhg/pRmxqJFi+jcuXO+RQkKkJZWLlDgFkzfvn2ZN28eCxcuzLcoLUbnzp3p27dvvsUIgpxIVcFI6gHcAGyDx0H6EfAmMB4ow+MiHZYEWTsE+APwGXCgmS2S1B+4wMyOaEr5HTp0YOPMYo0gCOokEx2hZlpzSbuJdAXwiJltCWwLvIHHp37CzDYDnkiOAU7FY1PfChyZpJ0PnJ2yjEFQ9KQVsic1BSNpTeB7wF8BzOwbM/sCOAC4Jcl2C3Bgsl8FdMJDxC6XNBRYYGZvpSVjEATpkmYTaRNgIXCTpG2BmcBJwDqZaI5mtkDS2kn+c4EpwEfA0cAEoN6mkaRRwCiAfv36pVGHIAiagdIaYZFUAbwA7GRm0yVdAXwJnGBmPbLyfW5mPWtcOxLoAUwHTgM+B04ys6X1lLcQyGXkvjfwaWPr0wqJerQuiq0eG5lZn4Yypalg1gVeMLOy5Hgo3t+yKbBzYr2sB0w1sy2yrisFJgF7Ao/iTaojgUozG9cCcs0ws4rm3iffRD1aF1GP2kmtD8bM/g18KCmjPIYBrwMPAiOTtJHAAzUuPR24wsyWA13w0acqvG8mCII2RNrzYE4A7pDUEXgX+CGu1CZIOg74ADg0k1nS+kCFmY1Okv6EN7O+oLozOAiCNkKqCsbMZgG1mVvD6sj/EbBv1vE9wD0tLNbYFr5fvoh6tC6iHrWQWh9MEARBQa9FCoIgv4SCCYIgNYpKwUg6RdIcSbMl3SWpTSxLlnSjpE8kzc5KW0vSY5LeSj5TWAvbstRRjz9K+qekVyXdn6xfa9XUVo+sc6dJMkm98yFbY6irHpJOkPRm8l+5pDllFI2CkbQBcCI+SrUNUEIDM4VbETcDw2uk1bWmqzVzM6vW4zFgGzMbCPwL+O3qFqoJ3Myq9UDShsDu+OhoW+BmatRD0i743LOBZrY1cGlzCigaBZPQHugiqT0+r+ajPMuTE2b2NL7KPJu61nS1Wmqrh5k9amYrksMXgFbvi6KO3wPgcnweV5sYOamjHj8HxpjZ10meZgU7KRoFY2bzcW38AbAA+I+ZPZpfqZrFSmu6gLUbyN8W+BEwOd9CNAVJ+wPzzewf+ZalmWwODJU0XdJTkrZvzs2KRsEkfRQHABsD6wNdJR2dX6mCDJJ+B6wA7si3LI0lWd7yO+D3+ZalBWgP9MRdp/wanxTbZJ+zRaNggN2A98xsYbIM4T5gxzzL1Bw+TtZykXzmIW5fy5Asbt0XOMra5sSs/viL6x+S5uLNvJeT9XhtjXnAfea8iC/TaXKHdTEpmA+AwZJKE408DHeA1VZpaE1Xm0DScOAMYP/6Vsu3ZszsNTNb28zKksW984BvJ+vx2hp/A3YFkLQ50JFmrBIvGgVjZtOBicDLwGt43dvE9G5JdwHPA1tImpfDtRnuAAAHdklEQVSs4xoD7C7pLXzkYkx992gN1FGPq4E1gMckzZJ0XV6FzIE66tHmqKMeNwKbJEPXdwMjm2NVxlKBIAhSo2gsmCAIVj+hYIIgSI1QMEEQpEYomCAIUiMUTBAEqVEwCiZZwfqnrOPTJI1uoXvfLOkHLXGvBso5VNIbkp5s4vU/k3RMI69ZX9LEppTX0kiqkHRlA3mOlXR1HecWt4AMf5C0W3Pv04RyV8sz1hgkTU2igzSZQopN/TVwsKSLzKzVhI+QVGJmlTlmPw74hZk1ScGYWaPnkCRuSvP+YEtqb2YzgBn5lMPMCmG6f6uhYCwYfB3LWOCUmidqvh0ybzpJOycLuiZI+pekMZKOkvSipNfksbEz7CbpmSTfvsn1JYk/k5cSfyY/zbrvk5LuxCf11ZRnRHL/2ZIuTtJ+DwwBrpP0xxr5c5JT0mhJpyX7J0p6PZHr7iTt+8lktlmSXpG0hqSyjD+QxDq4T9Ijcj8zl2TJcFxS9lRJ42paEZLaSZqrLH8ukt6WtI6k/eSL516R9LikdbLkHSvpUeDWpJ6TknPfkfRccs1zqo5OAbBhIuObks6p7WGQ9Ous3+XcJK2rpIck/SP57g+v71lJ6nOupJeT73nLWvLX9Qx0k/RE1rUHZF1zTJL3H5Juy7rd95K6vlubNVOX/JJ+n5Q/O/k+laRPlXS5pKfllvH2ye/7lqTzkzxlcn88tyQyTZSvrapZ9h6Snk/qc4+kbrV976tgZgWxAYuBNYG5QHc8YNvo5NzNwA+y8yafO+MRC9bDw9bOB85Nzp0E/Dnr+kdwhbwZPhW8Mx5V8qwkTyf87btxct8lwMa1yLk+vmyhD25B/j/gwOTcVNxfTc1rcpVzNHBasv8R0CnZ75F8/h0PhAfQLSm/DJidpB2LR3/ontTvfWDDROa5wFpAB+AZ4Opa5LwC+GGyvwPweLLfk+pJnT8G/pQl70ygS1Y9JyX7awLtk/3dgHuzZFwA9MLD2szOfGdZv+se+MtGyW82CQ9jfAgwLkve7rXU4WaSZyWp8wnJ/i+AG2rJX9cz0B5YM0nvDbydyLM18CbQOzm3Vla59yTyfgt4u5ayapU/c49k/zZgv6zn6eKs5+Qjqp+hecl3WIa7l8g8FzdS/QxNxZ329waeBrom6WcAv8/lf1lIFgxm9iVwK+5YKldeMrMF5v4v3sGDvYFbHmVZ+SaYWZV5rOx3gS3xB/kYSbPwKJS9cAUE8KKZvVdLedvjweYWmvtBuQN/+FtKzgyv4iFjjsatO4BpwGWSTsSVzoparnvCzP5jZl/hcaw2Ar4DPGVmn5kvFK0r0sN4IGMVHJEcgy/+myLpNXyF7tZZ1zxoZstquVd34J7Eurq8xjWPmdmi5Lr7cMsvmz2S7RV8aciW+O/yGm6JXixpqJn9p456ZHNf8jmT2r/nup4BARdKehV4HNgAWAdf5zPRkma8mWX7Y/lb8oy9nuStSV3y75JYiK8l91/p+826dk7WM/Qu/vIA+NDMpiX7t7Pq9zkYV3rTknqOxJ+LBikoBZPwZ7wvo2tW2gqSuibmY8esc19n7VdlHVexch9VzTUVhj9EJ5hZebJtbNU+ZpbUIV9Tl77nKmeGfYBrgEHATHkfxxjcgugCvFCbyV+jnMrk3rnK/DywqaQ+uAOszJ/zKtziGQD8FLeOMtT1PZ0HPGnufXC/GtfU9ltkI+CirN9lUzP7q5n9C/8+XgMukjdLGyLzfWS+i5rU9QwchVupg8ysHPg4qYNqkbdmWZn7rlzJWuSXu339C251DQDGsfJ3lf2c1HyGMvXJ5ft8LKuO3zKznNZfFZyCSd4IE3Alk2Eu/sOA+4Tp0IRbH5r0M/QHNsHN3CnAzyV1AF99KqlrfTfB33Lfl9RbUgkwAniqCfLUiaR2wIbmncWn43G+u0nqb77y92LclK9NwdTGi4nMPeXeAA+pLZO5/Xw/cBnwhpktSk51x5t1UL0CvCGyrzm2xrnd5T6Ju+CKbFqN81OAH2X6CSRtIGlteWC/pWZ2O+587Ns5ylIfdT0D3YFPzGy53A1l5o3/BHCYpF5J/rVyLagO+TPK5NOkvk3psO8n6bvJ/gjg2RrnXwB2krRpIkepfKV1gxTSKFI2fwKOzzoeBzwg6UX8B67rrVkfb+KKYB3gZ2b2laQbcLP55cQyWkgDrivNY3L/FngSfzM8bGYt7WqhBLhdUvekjMvN7AtJ5yUPeyXe/JmMt8nrxczmS7oQV44fJdfW1bwYD7zEykphNN7cmY8/rBvnUIdLgFsk/Qrvp8rmWbyvYVPgTvPRp2x5H5W0FfB80t+5GDg6yf9HSVXActw9ZHOp6xm4A/i7pBnALOCfiWxzJF0APCWpEm/GHZtjWQNqyp/8ruNwq2Yu/t03ljeAkZKuB94Crs0+aWYLJR0L3CWpU5J8Fu5DuV5iNXWQE5K6mdnixIK5H7jRzO7Pt1xB85BUhnesb5PG/QuuiRSkxuikg2828B7umCgI6iUsmCAIUiMsmCAIUiMUTBAEqREKJgiC1AgFEwRBaoSCCYIgNf4/nh36hj6Qev4AAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 288x216 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "nx,ny = 1,1\n",
    "fig, ax = plt.subplots(ny,nx,figsize=(nx*4,ny*3.0))\n",
    "\n",
    "ax.plot(acc[3:,0],acc[3:,2],'bs--',mfc='none',markersize=5,label='PLE')\n",
    "ax.plot(acc[3:,0],acc[3:,3],'ro-',markersize=5,label='EM')\n",
    "ax.set_xlabel('Number of missing variables in each sample')\n",
    "ax.set_ylabel('Accuracy')\n",
    "\n",
    "ax.set_xticks([8,10,12,14,16])\n",
    "ax.legend()\n",
    "\n",
    "vals = ax.get_yticks()\n",
    "ax.set_yticklabels(['{:,.0%}'.format(x) for x in vals])\n",
    "\n",
    "plt.tight_layout(h_pad=0.5, w_pad=0.6)\n",
    "#plt.savefig('fig3.pdf', format='pdf', dpi=100)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "It is clear that EM works significantly better than PLE. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
